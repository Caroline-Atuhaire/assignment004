---
title: "Data Science for Public Policy"
subtitle: "Assignment 04"
author: "Caroline Atuhaire - ca975"
execute:
  warning: false
format:
  html:
    embed-resources: true
    toc: true
    toc-location: left
---


```{r}

library(readxl)
library(writexl)
library(tidyverse)
library(tibble)

```

# Transfer the Data Format

```{r}
# Read Original File and Assign it to "data" 

data <- read_excel("data/0_OriginData_World_Development_Indicators.xlsx")

# Pivot longer to convert year columns into a "Year" column

data_long <- data |>
  pivot_longer(
    cols = starts_with("20"), 
    # Select all year columns (2001-2023)
    names_to = "Year",          
    # Move column names to "Year"
    values_to = "Value"
    # Store data values in "Value"
    )        

# Drop NAs contained by these cols

data_long <- data_long |>
  drop_na(`Country Name`, `Country Code`, `Series Code`, `Series Name`)

# Convert Year column to numeric

data_long$Year <- as.numeric(str_extract(data_long$Year, "\\d+"))

# Pivot wider to make Series Name values into separate columns

data_clean <- data_long |>
  select(-"Series Code") |>
  # delete the "Series Code" column
  pivot_wider(names_from = "Series Name", 
              values_from = "Value")

```

Here, we delete the "Series Code" column, because all the values in it have corresponding value in column "Series Name". If we don't delete it, all values of the variables would be misaligned and lots of blank rows when pivot_wider using "Series Name".


## Select and Rename Data

```{r}
# Define selected variables
data_available <- data_clean %>%
  select(
    country_name                = `Country Name`,
    country_code                = `Country Code`,
    year                        = `Year`,
    empl_agri                 = `Employment in agriculture (% of total employment) (modeled ILO estimate)`,
    empl_industry             = `Employment in industry (% of total employment) (modeled ILO estimate)`,
    empl_services             = `Employment in services (% of total employment) (modeled ILO estimate)`,
    final_cons_growth           = `Final consumption expenditure (annual % growth)`,
    gdp_growth                  = `GDP growth (annual %)`,
    lfpr_total_15_64_milo        = `Labor force participation rate, total (% of total population ages 15-64) (modeled ILO estimate)`,
    self_employed_total         = `Self-employed, total (% of total employment) (modeled ILO estimate)`,
    vulnerable_emp_total        = `Vulnerable employment, total (% of total employment) (modeled ILO estimate)`,
    wage_workers_total          = `Wage and salaried workers, total (% of total employment) (modeled ILO estimate)`)

```

Use **glimpse(data_available)** to see our new dataset. 

```{r}
# Mutate the chr into numeric
data_available_clean <- data_available |> 
  mutate(across(-c(country_name, country_code, year), as.numeric))

```
Create Codebook

```{r}

codebook <- tribble(
  ~new_variable,                    ~original_variable,                                                    
  "country_name",                   "Country Name",
  "country_code",                   "Country Code",
  "year",                           "Year",
  "empl_agri",                      "Employment in agriculture (% of total employment) (modeled ILO estimate)",
  "empl_industry",                  "Employment in industry (% of total employment) (modeled ILO estimate)",
  "empl_services",                  "Employment in services (% of total employment) (modeled ILO estimate)",
  "final_cons_growth",              "Final consumption expenditure (annual % growth)",
  "gdp_growth",                     "GDP growth (annual %)",
  "households_cons_growth",         "Households and NPISHs Final consumption expenditure (annual % growth)",
  "lfpr_total_15_64_milo",          "Labor force participation rate, total (% of total population ages 15-64) (modeled ILO estimate)",
  "self_employed_total",            "Self-employed, total (% of total employment) (modeled ILO estimate)",
  "vulnerable_emp_total",           "Vulnerable employment, total (% of total employment) (modeled ILO estimate)",
  "wage_workers_total",             "Wage and salaried workers, total (% of total employment) (modeled ILO estimate)"
)



```

# Labor Market Trends and Economic Growth: Evidence from China, Uganda, and the U.S.

## Examining Labor Force Participation, Sectoral Employment Shifts, Wage Employment, and Consumption Growth
Understanding the dynamics of labor markets is crucial for shaping economic policy and fostering sustainable growth. This analysis explores how labor force participation, employment distribution across sectors, and the rise of wage employment impact economic growth and consumption patterns. By comparing trends in China, Uganda, and the United States, the study examines whether increased employment in the service sector leads to more wage jobs and whether more wage workers drive higher household consumption. The findings provide insights into how economies transition and what factors determine whether labor market shifts translate into broader economic prosperity.

## Research Question
How do labor market trends—including labor force participation, sectoral employment shifts, and wage employment—affect economic growth and consumption across different economies?

## 1. Labor Force Participation and Economic Growth Over Time
A strong labor force is essential for economic growth. However, a high labor force participation rate (LFPR) does not always mean economic prosperity—growth depends on job quality and productivity.

```{r}
ggplot(data_available_clean, aes(x = year, group = country_name, color = country_name)) +
  geom_line(aes(y = lfpr_total_15_64_milo, linetype = "Labor Force Participation"), size = 1) +
  geom_point(aes(y = lfpr_total_15_64_milo), size = 2) +
  geom_line(aes(y = gdp_growth * 5, linetype = "GDP Growth"), size = 1) +
  geom_point(aes(y = gdp_growth * 5), size = 2) +
  scale_x_continuous(breaks = seq(min(data_available_clean$year), max(data_available_clean$year), by = 2)) +
  scale_y_continuous(sec.axis = sec_axis(~./5, name = "GDP Growth (%)")) +
  scale_linetype_manual(values = c("Labor Force Participation" = "solid", "GDP Growth" = "dashed")) +
  labs(
    title = "Labor Force Participation vs GDP Growth",
    subtitle = "Comparing Workforce Engagement and Economic Growth Across Countries",
    x = "Year", y = "Labor Force Participation (%)",
    color = "Country",
    linetype = "Indicator",  # This makes sure the legend correctly labels the lines
    caption = "Source: The World Bank, World Development Indicators (2025)."
  ) +
  theme_minimal() +
  theme(
    text = element_text(family = "serif"),
    panel.grid = element_blank(),
    plot.title = element_text(size = 14, face = "bold"),  
    plot.subtitle = element_text(size = 12, face = "italic"),  
    axis.title.x = element_text(size = 12),  
    axis.title.y = element_text(size = 12),  
    axis.text.x = element_text(size = 12),  
    axis.text.y = element_text(size = 12),
    legend.position = "bottom",
    axis.line = element_line(color = "black"),  # Ensures both x-axis and y-axis lines are visible
    legend.key.width = unit(0.8,"cm")
)
```

The relationship between labor force participation and GDP growth varies significantly across economies. The United States shows a gradual decline in labor force participation, with GDP growth fluctuating due to economic crises such as the 2008 financial crisis and COVID-19 in 2020. China initially had high labor force participation alongside strong GDP growth, but recent years show a slowdown in economic expansion, reflecting a transition to a more service-based economy. Uganda, on the other hand, maintains high but volatile labor force participation, with GDP growth following an inconsistent pattern due to economic instability and external shocks.


## 2. Employment Shifts Across Sectors
Economic development is often marked by a transition from agriculture to industry and services. A growing economy should see a decline in agricultural jobs and an increase in industrial and service employment.

```{r}
ggplot(data_available_clean, aes(x = year)) +
  geom_area(aes(y = empl_agri, fill = "Agriculture"), alpha = 0.6, position = "stack") +
  geom_area(aes(y = empl_industry, fill = "Industry"), alpha = 0.6, position = "stack") +
  geom_area(aes(y = empl_services, fill = "Services"), alpha = 0.6, position = "stack") +
  facet_wrap(~country_name) +
  labs(
    title = "Employment Distribution by Sector",
    subtitle = "Tracking the Shift in Employment Across Agriculture, Industry, and Services",
    x = "Year", y = "Employment Share (%)",
    fill = "Sector",
    caption = "Source: World Bank Data"
  ) +
  scale_fill_brewer(palette = "Set2") +  # Improved color scheme for better distinction
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +  

    theme_minimal() +
  theme(
    text = element_text(family = "serif"),
    panel.grid = element_blank(),
    plot.title = element_text(size = 14, face = "bold"),  
    plot.subtitle = element_text(size = 12, face = "italic"),  
    axis.title.x = element_text(size = 12),  
    axis.title.y = element_text(size = 12),  
    axis.text.x = element_text(size = 12),  
    axis.text.y = element_text(size = 12),
    legend.position = "bottom",
    axis.line = element_line(color = "black"),  # Ensures both x-axis and y-axis lines are visible
    legend.key.width = unit(0.8,"cm")
)


```
Employment patterns reveal structural transformations in different economies. China’s workforce is shifting away from agriculture, with a growing share of employment in industry and services, signifying industrialization. Uganda’s labor market remains heavily dependent on agriculture, with only slow growth in industry and services, indicating limited economic diversification. In contrast, the United States is dominated by the service sector, with minimal employment in agriculture and industry, reflecting the maturity of a developed economy.


## 3. As Employment in Services Increases, Wage Workers Rise.

```{r}

ggplot(data_available_clean, aes(x = empl_services, y = wage_workers_total, color = country_name)) +
  geom_point(size = 3, alpha = 0.7) +  # Scatter points with transparency
  geom_smooth(method = "lm", se = FALSE, linetype = "dashed", color = "black") +  # Trend line per country
  facet_wrap(~country_name, scales = "free") +  # Separate plots for each country
  labs(
    title = "As Employment in Services Increases, Wage Workers Rise",
    subtitle = "Comparing Growth in Service Sector Jobs and Wage Employment",
    x = "Employment in Services (% of Total Employment)", 
    y = "Wage Workers (% of Total Employment)",
    color = "Country",
    caption = "Source: World Bank Data"
  ) +
    theme_minimal() +
  theme(
    text = element_text(family = "serif"),
    panel.grid = element_blank(),
    plot.title = element_text(size = 14, face = "bold"),  
    plot.subtitle = element_text(size = 12, face = "italic"),  
    axis.title.x = element_text(size = 12),  
    axis.title.y = element_text(size = 12),  
    axis.text.x = element_text(size = 12),  
    axis.text.y = element_text(size = 12),
    legend.position = "bottom",
    axis.line = element_line(color = "black"),  
    legend.key.width = unit(0.8,"cm")
)

```


The graph illustrates how increasing employment in the service sector correlates with the rise of wage jobs across China, Uganda, and the United States. In China, steady growth in service employment has been accompanied by a consistent rise in wage jobs, reflecting a structured transition to a more formal labor market. In Uganda, while service employment has increased, wage job trends have been unstable, indicating that many service roles remain informal or low-paying. In the United States, where the economy is predominantly service-based, wage employment remains consistently high due to strong labor regulations and the formal nature of most service jobs.


## 4. Wage Employment vs. Household Consumption Growth

```{r}
library(ggplot2)
library(dplyr)
library(tidyr)

# Ensure data is correctly reshaped
data_long <- data_available_clean %>%
  select(year, country_name, wage_workers_total, final_cons_growth) %>%
  pivot_longer(cols = c(wage_workers_total, final_cons_growth),
               names_to = "Metric",
               values_to = "Value")  # Ensure this column is correctly created

# Improve labels
data_long$Metric <- recode(data_long$Metric,
                           "wage_workers_total" = "Wage Workers (% of Total Employment)",
                           "final_cons_growth" = "Final Consumption Growth (%)")

# Check the structure of data to ensure 'Value' exists
print(head(data_long))

# Create bar graph
ggplot(data_long, aes(x = factor(year), y = Value, fill = Metric)) +  # Convert year to factor for discrete x-axis
  geom_col(position = "dodge", alpha = 0.8) +
  facet_wrap(~country_name) +  # Create separate plots per country
  scale_fill_manual(values = c("Wage Workers (% of Total Employment)" = "lightblue",
                               "Final Consumption Growth (%)" = "gold")) +
  labs(
    title = "Wage Employment vs. Consumption Growth Over Time",
    subtitle = "Are Wage Jobs Driving Higher Consumption?",
    x = "Year",
    y = "Percentage (%)",
    fill = "Indicator",
    caption = "Source: World Bank Data"
  ) +
    theme_minimal() +
  theme(
    text = element_text(family = "serif"),
    panel.grid = element_blank(),
    plot.title = element_text(size = 14, face = "bold"),  
    plot.subtitle = element_text(size = 12, face = "italic"),  
    axis.title.x = element_text(size = 12),  
    axis.title.y = element_text(size = 12),  
    axis.text.x = element_text(size = 12),  
    axis.text.y = element_text(size = 12),
    legend.position = "bottom",
    axis.line = element_line(color = "black"),  # Ensures both x-axis and y-axis lines are visible
    legend.key.width = unit(0.8,"cm")
)


```
The graph explores whether an increase in wage employment leads to higher household consumption across China, Uganda, and the United States. In China, wage employment has grown steadily, but consumption growth remains moderate, suggesting that rising wages or job stability may be necessary to boost spending. In Uganda, wage employment and consumption growth are both volatile, indicating that many jobs remain low-paying or informal, limiting their impact on household spending. In the United States, where wage employment is consistently high, consumption growth remains stable, reflecting a strong link between formal employment, financial security, and sustained consumer demand.

## Policy recommendation

Whereas employment in services increases wage workers, it may not necessarily lead to higher household consumption, as shown across the four graphs. In China and Uganda, rising service sector employment has not consistently translated into higher consumption, suggesting that low wages and job instability limit spending power. In contrast, the United States demonstrates that stable wage employment supports sustained consumption growth, highlighting the importance of job quality and fair wages. Therefore, policymakers should ensure wage growth aligns with productivity, strengthen labor protections, and implement policies that boost disposable income to drive household consumption and economic growth.



